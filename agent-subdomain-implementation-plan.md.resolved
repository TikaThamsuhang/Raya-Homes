# Agent Subdomain Implementation Plan

## Overview
This document outlines the strategy for hosting individual agent profile pages as subdomains (e.g., `sarah-jenkins.rayahomes.com`, `michael-chang.rayahomes.com`).

## Current Architecture

### Existing Setup
- **Main Site**: `rayahomes.com`
- **Agent Profiles**: Currently at `rayahomes.com/agent/index.html?id=agent-1`
- **Agent Data**: Stored in [agent/js/agents-data.js](file:///c:/Work/Raya%20Homes/agent/js/agents-data.js)
- **Agent Template**: Single template at [agent/index.html](file:///c:/Work/Raya%20Homes/agent/index.html) that dynamically loads data based on URL parameter

### Current Agent Data Structure
```javascript
const agentsData = {
  "agent-1": {
    name: "Sarah Jenkins",
    title: "Senior Luxury Estate Agent",
    // ... other properties
  },
  "agent-2": {
    name: "Michael Chang",
    // ...
  }
}
```

## Recommended Subdomain Architecture

### Option 1: Dynamic Subdomain with Wildcard DNS (Recommended)
**Best for**: Scalability, easy agent onboarding, centralized management

#### How It Works:
1. **DNS Configuration**:
   - Set up wildcard DNS: `*.rayahomes.com` → Your server IP
   - All subdomains (sarah-jenkins, michael-chang, etc.) automatically route to your server

2. **Server-Side Routing**:
   - Server detects the subdomain from the request
   - Serves the same [agent/index.html](file:///c:/Work/Raya%20Homes/agent/index.html) template
   - Passes agent identifier to JavaScript

3. **URL Structure**:
   - `sarah-jenkins.rayahomes.com` → Loads agent-1 data
   - `michael-chang.rayahomes.com` → Loads agent-2 data

#### Implementation Steps:

**Step 1: DNS Setup**
```
Type: A Record
Host: *
Points to: Your Server IP
TTL: 3600
```

**Step 2: Server Configuration**

**For Apache (.htaccess)**:
```apache
RewriteEngine On
RewriteCond %{HTTP_HOST} ^([^.]+)\.rayahomes\.com$ [NC]
RewriteCond %{HTTP_HOST} !^www\. [NC]
RewriteRule ^$ /agent/index.html?subdomain=%1 [L,QSA]
```

**For Nginx**:
```nginx
server {
    server_name *.rayahomes.com;
    
    location / {
        if ($host ~* ^([^.]+)\.rayahomes\.com$) {
            set $subdomain $1;
            rewrite ^/$ /agent/index.html?subdomain=$subdomain last;
        }
    }
}
```

**For Node.js/Express**:
```javascript
app.get('*', (req, res) => {
    const subdomain = req.hostname.split('.')[0];
    
    // Skip www and main domain
    if (subdomain !== 'www' && subdomain !== 'rayahomes') {
        // Serve agent page with subdomain parameter
        res.sendFile(__dirname + '/agent/index.html');
    }
});
```

**Step 3: Update Agent JavaScript**

Modify [agent/js/agent.js](file:///c:/Work/Raya%20Homes/agent/js/agent.js) to detect subdomain:

```javascript
// Get agent identifier from subdomain or URL parameter
function getAgentIdentifier() {
    // Check for subdomain first
    const hostname = window.location.hostname;
    const parts = hostname.split('.');
    
    // If subdomain exists (not www or main domain)
    if (parts.length >= 3 && parts[0] !== 'www') {
        const subdomain = parts[0];
        return subdomainToAgentId(subdomain);
    }
    
    // Fallback to URL parameter
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get('id') || 'agent-1';
}

// Map subdomain to agent ID
function subdomainToAgentId(subdomain) {
    const mapping = {
        'sarah-jenkins': 'agent-1',
        'michael-chang': 'agent-2',
        'emily-rodriguez': 'agent-3',
        // Add more mappings as needed
    };
    
    return mapping[subdomain] || 'agent-1';
}

// Use this instead of direct URL parameter
const agentId = getAgentIdentifier();
```

**Step 4: Update Agent Data**

Add subdomain field to [agents-data.js](file:///c:/Work/Raya%20Homes/agent/js/agents-data.js):

```javascript
const agentsData = {
  "agent-1": {
    name: "Sarah Jenkins",
    subdomain: "sarah-jenkins",
    title: "Senior Luxury Estate Agent",
    // ... rest of data
  },
  "agent-2": {
    name: "Michael Chang",
    subdomain: "michael-chang",
    // ...
  }
}
```

**Step 5: Update Links Throughout Site**

Replace all agent profile links:
```javascript
// OLD:
href="agent/index.html?id=agent-1"

// NEW:
href="https://sarah-jenkins.rayahomes.com"
```

---

### Option 2: Static Subdomain Pages
**Best for**: Small number of agents, SEO optimization, no server-side logic needed

#### How It Works:
1. Create separate folders for each agent
2. Each subdomain points to its own folder
3. Duplicate the agent template for each agent with hardcoded data

#### Structure:
```
/
├── index.html (main site)
├── sarah-jenkins/
│   └── index.html (Sarah's profile)
├── michael-chang/
│   └── index.html (Michael's profile)
└── emily-rodriguez/
    └── index.html (Emily's profile)
```

#### DNS Configuration:
```
sarah-jenkins.rayahomes.com → /sarah-jenkins/
michael-chang.rayahomes.com → /michael-chang/
```

#### Pros:
- No server-side logic needed
- Better for SEO (unique content per page)
- Works on any static hosting

#### Cons:
- Harder to maintain (duplicate code)
- Adding new agents requires manual work
- Updates must be applied to all agent pages

---

## Recommended Approach: Option 1 (Dynamic Subdomain)

### Why Option 1 is Better:
1. **Scalability**: Add new agents by just updating [agents-data.js](file:///c:/Work/Raya%20Homes/agent/js/agents-data.js)
2. **Maintainability**: Single template to update
3. **Consistency**: All agents have identical functionality
4. **Easy Updates**: Change design once, applies to all agents

### Implementation Checklist:

- [ ] Set up wildcard DNS record (`*.rayahomes.com`)
- [ ] Configure server routing (Apache/Nginx/Node.js)
- [ ] Add subdomain field to all agents in [agents-data.js](file:///c:/Work/Raya%20Homes/agent/js/agents-data.js)
- [ ] Update [agent.js](file:///c:/Work/Raya%20Homes/js/find-agent.js) to detect subdomain
- [ ] Create subdomain-to-agent-id mapping
- [ ] Update all agent profile links site-wide
- [ ] Test each agent subdomain
- [ ] Set up SSL certificates for wildcard domain
- [ ] Update sitemap.xml with agent subdomains
- [ ] Configure analytics to track subdomains

### Testing:
1. Test main domain: `rayahomes.com`
2. Test agent subdomains: `sarah-jenkins.rayahomes.com`
3. Test fallback: `rayahomes.com/agent/index.html?id=agent-1`
4. Test 404 for invalid subdomains

### SEO Considerations:
- Add canonical URLs to prevent duplicate content
- Create unique meta titles/descriptions per agent
- Generate sitemap with all agent subdomains
- Set up proper redirects from old URLs

### SSL Certificate:
- Use wildcard SSL: `*.rayahomes.com`
- Most providers (Let's Encrypt, Cloudflare) support wildcard certs
- Single cert covers all agent subdomains

## Alternative: Subdirectory Approach
If subdomains are not feasible, use subdirectories:
- `rayahomes.com/agents/sarah-jenkins/`
- `rayahomes.com/agents/michael-chang/`

This is simpler but less "premium" feeling than subdomains.

## Next Steps
1. Choose hosting provider that supports wildcard DNS
2. Decide between Option 1 (dynamic) or Option 2 (static)
3. Implement server configuration
4. Update codebase with subdomain detection
5. Test thoroughly before going live
